steps:
  - script: |
          %CD:~0,2%\msys64\usr\bin\bash -lc 'wget https://www.sqlite.org/src/tarball/sqlite.tar.gz?r=release; tar -xf sqlite.tar.gz; cd sqlite/tool; /mingw64/bin/gcc -s -O2 -o lemon lemon.c'
    displayName: Build lemon
    env:
      MSYSTEM: $(MINGW_UPPER)
      CHERE_INVOKING: yes
      MINGW_INSTALLS: $(MINGW_LOWER)
  - task: PublishBuildArtifacts@1
    displayName: Publish lemon
    continueOnError: true
    inputs:
      pathtoPublish:
        - $(Build.SourcesDirectory)/sqlite/tool/lemon.exe
        - $(Build.SourcesDirectory)/sqlite/tool/lempar.c
      artifactName: lemon